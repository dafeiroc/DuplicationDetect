<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<%@ page language="java" pageEncoding="GBK" %>
<%
    String path = request.getContextPath();
    String basePath = request.getScheme() + "://" + request.getServerName() + ":" + request.getServerPort() + path + "/";
    String dataset_id = (null == request.getAttribute("dataset_id")) ? String.valueOf(1) : (String) request.getAttribute("dataset_id");
%>
<html>
<head>

    <title> 图片重定向 陆硕的毕业设计</title>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="This is my page">
    <meta http-equiv=Content-Type content="text/html;charset=gbk">
    <link href="<%=basePath%>css/alex-style.css" type="text/css" rel="stylesheet"/>

    <script src="<%=basePath%>js/jquery1.js" type="text/javascript"></script>


</head>

<body style="background-color: #000000">

<script>
    <!--

    // following are some javascripts automatically generated by Adobe Dreamweaver in order
    // to handle the change of display on mouse-over events

    function MM_preloadImages() { //v3.0
        var d = document;
        if (d.images) {
            if (!d.MM_p)
                d.MM_p = new Array();
            var i,j = d.MM_p.length
            var a = MM_preloadImages.arguments;
            for (i = 0; i < a.length; i++)
                if (a[i].indexOf("#") != 0) {
                    d.MM_p[j] = new Image;
                    d.MM_p[j++].src = a[i];
                }
        }
    }

    function MM_swapImgRestore() { //v3.0
        var i,x,a = document.MM_sr;
        for (i = 0; a && i < a.length && (x = a[i]) && x.oSrc; i++) {
            x.src = x.oSrc;
        }
    }

    function MM_findObj(n, d) { //v4.01
        var p,i,x;
        if (!d)
            d = document;
        if ((p = n.indexOf("?")) > 0 && parent.frames.length) {
            d = parent.frames[n.substring(p + 1)].document;
            n = n.substring(0, p);
        }
        if (!(x = d[n]) && d.all)
            x = d.all[n];
        for (i = 0; !x && i < d.forms.length; i++)
            x = d.forms[i][n];
        for (i = 0; !x && d.layers && i < d.layers.length; i++)
            x = MM_findObj(n, d.layers[i].document);
        if (!x && d.getElementById)
            x = d.getElementById(n);
        return x;
    }

    function MM_swapImage() { //v3.0
        var i,j = 0,x,a = MM_swapImage.arguments;
        document.MM_sr = new Array;
        for (i = 0; i < (a.length - 2); i += 3)
            if ((x = MM_findObj(a[i])) != null) {
                document.MM_sr[j++] = x;
                if (!x.oSrc)
                    x.oSrc = x.src;
                x.src = a[i + 2];
            }
    }

    // Functions to handle result selection

    function markImage(obj) {
        var selected_id = $(obj).attr('id');

        if (selected_id == 'res1') {
            unselected_id = 'res2';
            selected_side = 'left';
            unselected_side = 'right';
            $('#selected_id').val($('#res1_id').val());
        } else {
            unselected_id = 'res1';
            selected_side = 'right';
            unselected_side = 'left';
            $('#selected_id').val($('#res2_id').val());
        }
        // turn this on
        $(obj).css('border', '5px solid red');
        // turn the other off
        $('#' + unselected_id).css('border', '5px solid black');

        $('#next_button').removeAttr('disabled'); // enable the button
    }

    function next_onClick() {
        // record time
        var endtime = new Date().getTime();
        $('#time').val((endtime - starttime) / 1000.0);

        document.compareForm.submit();
    }

    $(document).ready(function() {
        MM_preloadImages('<%=basePath%>data/<%=dataset_id%>/1.jpg', '<%=basePath%>data/<%=dataset_id%>/2.jpg');
    });

    var starttime; // global

    //start timer after the entire page has loaded
    window.onload = function() {
        starttime = new Date().getTime();
    };

    //-->
</script>

<div id="page">
    <table width="1024px" border="0" align="center">
        <tbody>
        <tr>
            <td>
                <div align="left">
                    <b>(<%=dataset_id%>/30):</b>
                    <br/>mouse over 查看retarget后的图片
                    <br/>单击选择你认为合适的并提交.
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <hr>
            </td>
        </tr>
        <tr>
            <td>
                <div align="center">
                    <table border="0px" align="center">
                        <tbody>
                        <tr>
                            <td>
                                <div align="center"><img onclick="markImage(this)"
                                                         onmouseover="MM_swapImage('display','','<%=basePath%>data/<%=dataset_id%>/1.jpg',1)"
                                                         style="border: 5px solid black;" class="thumb" name="res1"
                                                         id="res1" src="<%=basePath%>data/<%=dataset_id%>/1_thumb.jpg">
                                </div>
                            </td>
                            <td>
                                <div align="center"><img onclick="markImage(this)"
                                                         onmouseover="MM_swapImage('display','','<%=basePath%>data/<%=dataset_id%>/2.jpg',2)"
                                                         style="border: 5px solid red;" class="thumb" name="res2"
                                                         id="res2" src="<%=basePath%>data/<%=dataset_id%>/2_thumb.jpg">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div align="center">1</div>
                            </td>
                            <td>
                                <div align="center">2</div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <table cellspacing="10px" border="0px" align="center">
                    <tbody>
                    <tr>
                        <td><img src="<%=basePath%>data/<%=dataset_id%>/src.jpg"></td>
                        <td><img id="display" name="display" src="<%=basePath%>data/<%=dataset_id%>/2.jpg"></td>
                    </tr>
                    <tr>
                        <td>
                            <div align="center">源文件</div>
                        </td>
                        <td>
                            <div align="center">Retarget后的文件</div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        <tr>
            <td align="center">
                <br>

                <form method="get" action="<%=basePath%>retarget/collect" name="compareForm">
			<span id="basicForm">
			  <input type="button" style="width:100px;" onclick="next_onClick()" value="Next &gt;&gt;" id="next_button">
			  <input type="hidden" value="2" name="selected_id" id="selected_id">
			  <input type="hidden" value="<%=dataset_id%>" name="dataset_id" id="dataset_id">
			  <input type="hidden" value="1" name="res1_id" id="res1_id">
			  <input type="hidden" value="2" name="res2_id" id="res2_id">

			  <input type="hidden" value="<%=dataset_id%>" name="pageid" id="pageid">
			  <input type="hidden" value="" name="time" id="time">
		      <input type="hidden" value="compareForm" name="formname" id="formname">
			</span>
                </form>
            </td>
        </tr>
        <!-- for some reason, the progress bar does not show right if I directly align the td or div -->
        </tbody>
    </table>

</div>
</body>
</html>